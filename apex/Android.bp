package {
    default_applicable_licenses: ["Android-Apache-2.0"],
}

apex {
    name: "com.android.virt",

    // TODO(jiyong): make it updatable
    updatable: false,

    manifest: "manifest.json",

    key: "com.android.virt.key",
    certificate: ":com.android.virt.certificate",

    // crosvm is enabled for only 64-bit targets on device
    arch: {
        arm64: {
            binaries: [
                "authfs", // TODO(victorhsieh): move to microdroid once we can run the test in VM.
                "crosvm",
            ],
        },
        x86_64: {
            binaries: [
                "authfs", // TODO(victorhsieh): move to microdroid once we can run the test in VM.
                "crosvm",
            ],
        },
    },
    binaries: [
        "assemble_cvd",
        "fd_server",
        "virtmanager",
        "vm",
    ],
    filesystems: ["microdroid"],
    prebuilts: ["com.android.virt.init.rc"],
    file_contexts: ":com.android.virt-file_contexts",
}

apex_key {
    name: "com.android.virt.key",
    public_key: "com.android.virt.avbpubkey",
    private_key: "com.android.virt.pem",
}

android_app_certificate {
    name: "com.android.virt.certificate",
    certificate: "com.android.virt",
}

prebuilt_etc {
    name: "com.android.virt.init.rc",
    src: "virtmanager.rc",
    filename: "init.rc",
}
